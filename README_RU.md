# Coffer

Простая key-value ACID* база данных.

*is a set of properties of database transactions intended to guarantee validity even in the event of errors, power failures, etc.

### Старт

При старте последним по номеру должен быть чекпойнт. Если это не так, то значит, остановка была некорректной.
Тогда грузится последний имеющийся чекпоинт и все логи после него до тех пор, пока это возможно. На битом логе
или последнем логе скачиваем, пока получается, и на этом загрузку заканчиваем. БД создаёт новый чекпоинт,
и после этого возможно продолжение исполнение кода.

### Follow

После того, как БД будет запущена, она пишет все операции в журнал. В результате лог может сильно разрастись.
Если в конце концов при окончании работы приложения БД будет корректно остановлена,
то появится новый чекпойнт, и при последующем старте именно из него и будут взяты данные.
Однако, остановка может оказаться некорректной, и новый чекпойнт создан не будет.

В этом случае при новом старте БД будет вынуждена загрузить старый чекпоинт, и провести заново все операции,
которые были совершены и записаны в журнал. Это может оказаться весьма значительным по времени, и в конечном
итоге база будет грузиться значительно дольше, что не всегда приемлемо для приложений.

Именно поэтому в БД существует механизм фолловера, который методично перебирает логи в процессе работы БД
и периодически создаёт чекпойнты, которые значительно ближе по состоянию к текущему моменту.
Также за фолловером можно закрепить функцию чистки старых логов и чекпойнтов, чтобы освобождать
место на жёстком диске.

### Copyright © 2019 Eduard Sesigin. All rights reserved. Contacts: <claygod@yandex.ru>